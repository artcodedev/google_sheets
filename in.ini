–ß—Ç–æ–±—ã –ø—Ä–æ—Å—Ç–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–≤–æ–µ–π Google –¢–∞–±–ª–∏—Ü–µ –±–µ–∑ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏, –≤–∞–º –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –°–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç (Service Account). –≠—Ç–æ—Ç —Ç–∏–ø —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–æ–≥–ª–∞—Å–∏—è –∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç–æ –µ—Å—Ç—å, –≤–∞—Å), —á—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±—Ö–æ–¥–∏—Ç —ç–∫—Ä–∞–Ω –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏.

–ß—Ç–æ —Ç–∞–∫–æ–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç?
–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç OAuth 2.0, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–π—Å—Ç–≤—É–µ—Ç –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –¥–µ–π—Å—Ç–≤—É–µ—Ç –æ—Ç –∏–º–µ–Ω–∏ —Å–∞–º–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–ª—è –Ω–µ–≥–æ –Ω–µ –Ω—É–∂–µ–Ω –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ –±—Ä–∞—É–∑–µ—Ä –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
–®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ üõ†Ô∏è
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Google Cloud Console > IAM –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ > –°–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã.

–ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç".

–î–∞–π—Ç–µ –µ–º—É –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, sheets-access) –∏ –æ–ø–∏—Å–∞–Ω–∏–µ, –∑–∞—Ç–µ–º –Ω–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å".

–ù–∞ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç—É —Ä–æ–ª—å, –Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã —ç—Ç–æ –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å. –ù–∞–∂–º–∏—Ç–µ "–ì–æ—Ç–æ–≤–æ".

–®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞ JSON üîë
–ù–∞–π–¥–∏—Ç–µ —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –≤ —Å–ø–∏—Å–∫–µ –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –µ–≥–æ –∏–º—è.

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤–æ –≤–∫–ª–∞–¥–∫—É "–ö–ª—é—á–∏".

–ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á" > "–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª—é—á".

–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø "JSON" –∏ –Ω–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å".

–§–∞–π–ª JSON –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ –≤–∞—à –∫–æ–º–ø—å—é—Ç–µ—Ä. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –≤ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º –º–µ—Å—Ç–µ –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, service_account.json).

–®–∞–≥ 3: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ Google –¢–∞–±–ª–∏—Ü–µ ü§ù
–≠—Ç–æ—Ç —à–∞–≥ —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π!

–û—Ç–∫—Ä–æ–π—Ç–µ —Å–≤–æ—é Google –¢–∞–±–ª–∏—Ü—É.

–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞" (Share) –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É.

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞. –ï–≥–æ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤–æ –≤–∫–ª–∞–¥–∫–µ "–°–≤–µ–¥–µ–Ω–∏—è" —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ Cloud Console.

–í—Å—Ç–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å –≤ –ø–æ–ª–µ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–ª—è –Ω–µ–≥–æ —Ä–æ–ª—å "–†–µ–¥–∞–∫—Ç–æ—Ä" (Editor) –∏–ª–∏ "–ß–∏—Ç–∞—Ç–µ–ª—å" (Viewer), –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–∏—Ö –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π. –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å".

–®–∞–≥ 4: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞ –≤ –∫–æ–¥–µ üíª
–¢–µ–ø–µ—Ä—å –≤–∞—à –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç JSON-—Ñ–∞–π–ª –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

TypeScript

import { google } from 'googleapis';
import * as path from 'path';

// –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ –≤–∞—à–µ–º—É JSON-—Ñ–∞–π–ª—É —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
const KEY_FILE_PATH = path.join(process.cwd(), 'service_account.json');

// –û–±–ª–∞—Å—Ç—å –¥–æ—Å—Ç—É–ø–∞ (scopes)
const SCOPES = ['https://www.googleapis.com/auth/spreadsheets'];

async function getAuth() {
  const auth = new google.auth.GoogleAuth({
    keyFile: KEY_FILE_PATH,
    scopes: SCOPES,
  });

  // –ü–æ–ª—É—á–∞–µ–º –∫–ª–∏–µ–Ω—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  const client = await auth.getClient();
  return client;
}

async function main() {
  const authClient = await getAuth();
  const sheets = google.sheets({ version: 'v4', auth: authClient as any });

  const spreadsheetId = '–í–ê–®_ID_–¢–ê–ë–õ–ò–¶–´';
  const range = '–õ–∏—Å—Ç1!A1:B10';

  try {
    const res = await sheets.spreadsheets.values.get({
      spreadsheetId,
      range,
    });
    console.log(res.data.values);
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞:', error);
  }
}

main();
–ò—Å–ø–æ–ª—å–∑—É—è —ç—Ç–æ—Ç –º–µ—Ç–æ–¥, –≤—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–æ–π–¥–µ—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–π "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å" –¥–ª—è –≤–∞—à–µ–π —Ç–∞–±–ª–∏—Ü—ã.